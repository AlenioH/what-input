!function(root,factory){"function"==typeof define&&define.amd?define([],function(){return factory()}):"object"==typeof exports?module.exports=factory():root.whatInput=factory()}(this,function(){function bufferInput(event){clearTimeout(timer),setInput(event),buffer=!0,timer=setTimeout(function(){buffer=!1},1e3)}function regularInput(event){buffer||setInput(event)}function setInput(event){var eventKey=key(event),eventTarget=target(event),value=inputMap[event.type];console.log(keyMap[eventKey]),currentInput!==value&&(!formTyping&&currentInput&&"keyboard"===value&&"tab"!==keyMap[eventKey]&&formInputs.indexOf(eventTarget.nodeName.toLowerCase())>=0||(currentInput=value,body.setAttribute("data-whatinput",currentInput),-1===inputTypes.indexOf(currentInput)&&inputTypes.push(currentInput)))}function key(event){return event.keyCode?event.keyCode:event.which}function target(event){return event.target||event.srcElement}var timer,body=document.body,buffer=!1,currentInput=null,formInputs=["input","select","textarea"],formTyping=body.hasAttribute("data-whatinput-formtyping"),inputMap={keydown:"keyboard",mousedown:"mouse",touchstart:"touch",pointerdown:"pointer",MSPointerDown:"pointer"},inputTypes=[],keyMap={9:"tab",13:"enter",16:"shift",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};return function(){var pointerPrefix="onmspointerdown"in window?"ms":"";if("on"+pointerPrefix+"pointerdown"in window){var pointerdown=pointerPrefix+"pointerdown";body.addEventListener(pointerdown,regularInput)}else body.addEventListener("mousedown",regularInput),"ontouchstart"in window&&body.addEventListener("touchstart",bufferInput);body.addEventListener("keydown",regularInput)}(),{ask:function(){return currentInput},types:function(){return inputTypes},set:setInput}});